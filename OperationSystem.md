# 操作系统的启动

  磁盘： 存放OS
  BIOS ： 基本的I/O操作
  bootload: 加载OS

  1. 电脑设备刚开始的启动的时候，需要从一个固定的内存地址进行执行（例如x86是从0xfff0开始的）,该段程序一般称为boot,并且存放在rom中。 
  2. boot的主要任务是进行设备自检（post)和在磁盘的第一个扇区将bootload（一般为512字节）读取到内存固定的地址（例如x86为0x7fc00）
  3. bootload的主要的任务是将OS读取到内存中，并且执行OS，此时该设备才真正的由操作系统来进行掌握。

# 操作系统对外暴露的接口

操作系统对外暴露的接口有系统调用，异常和中断。其中系统调用和异常是面向应用程序的，中断是面向外设。

## 系统调用

系统调用是应用程序需要操作系统提供服务的请求。

通常情况下，每一个系统调用都有一个序号，操作系统通过序号来维护系统调用的索引表。
系统调用接口（例如C的系统头文件、Java ApI）调用内核态中预期的系统调用

### 系统调用与函数调用的区别

函数调用是在一个栈空间中进行参数的传递和结果的返回，而系统调用是在应用程序和操作系统的两个堆栈中进行参数传递和结果返回

## 异常

异常是应用程序被动的接受操作系统的服务，一般是应用程序执行了非法的指令或错误的操作。

每一个异常都有一个编号，该编号对应着每一异常的服务程序，在操作系统中有一张表管理的这所有的异常，key为异常号，value为异常服务程序的地址。
当一个应用程序执行了一个非法的指令，会产生一个异常的编号，通过该编号，操作系统找到异常服务程序。

和中断相同，在进入中断程序之前要保存当前程序执行的现场，最后要根据异常服务程序返回的结果，来对应用程序执行不同措施，例如杀死应用程序、重新启动应用程序、跳过该异常等。

## 中断

来自不同外设向操作系统发出的请求。
在操作系统中，对不同外设的中断进行编号，每一个中断编号对应某一个外设的中断程序，为了更好的对所有外设的中断进行管理，在操作系统存放着一张表，用key(编号)-value（中断服务程序的编号）的形式进行管理，该表叫做中断向量表。

中断的实现需要硬件和软件的配合

硬件： 产生中断号，操作系统通过中断号找到对应的中断服务程序
软件： 保存当前正在执行程序的所有状态，包括寄存器中的值，堆栈，程序指针等，用来实现中断返回时，再次执行当前程序，该过程叫做保存现场。
       根据中断号找到对应的中断服务程序，并执行
       中断服务程序程序执行完成后，将保存的当前程序的执行过程恢复，此过程叫恢复现场

## 跨越操作系统的边界的开销

跨越操作系统的边界是指 外设到操作系统  应用程序到操作系统以及操作系统到外设  操作系统到应用程序

开销： 
1. 建立中断\异常\系统调用号与对应服务程序的映射关系的开销
2. 建立内核堆栈的开销
3. 检验外设或应用程序传递过来的参数的开销
4. 内核态映射到用户态的地址空间（将内核态执行服务程序的执行的结果复制到应用程序（用户态））  更新页面映射权限（不明白）
5. 内核态独立的地址空间。

